(self.webpackChunkdavid_project=self.webpackChunkdavid_project||[]).push([[489],{6442:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return O}});var r=t(1413),a=t(2982),o=t(885),l=t(2791),u=t(5048),c=t(8182),s=t(2426),i=t.n(s),d=t(4554),p=t(5519),f=t(6151),x=t(890),h=t(8264),m=t(1795),v=t(7630),Z=t(412),b=t(2740),j=t(6409),D=t(184),g=(0,v.ZP)(b.Z)((function(){return{"& .MuiOutlinedInput-root":{cursor:"pointer","& input.MuiOutlinedInput-input":{cursor:"pointer"}}}})),C=function(){var e=(0,u.v9)((function(e){return{fcs:e.Help.fcs,currentFc:e.Help.currentFc}}),u.wU),n=e.fcs,t=e.currentFc,c=l.useState(""),s=(0,o.Z)(c,2),i=s[0],d=s[1],p=(0,u.I0)(),f=(0,l.useMemo)((function(){if(!n)return[];var e=n.map((function(e){return e.name}));return e=(0,a.Z)(new Set(e)),e=["All"].concat(e)}),[n]),x=(0,l.useCallback)((function(e){p((0,j.In)(e))}),[]);return(0,D.jsx)("div",{children:(0,D.jsx)(g,{value:t,onChange:function(e,n){x(n)},disableClearable:!0,inputValue:i,onInputChange:function(e,n){d(n)},size:"small",options:f,sx:{width:250},renderInput:function(e){return(0,D.jsx)(Z.Z,(0,r.Z)((0,r.Z)({},e),{},{label:"Warehouse"}))}})})},M=(0,l.memo)(C),Y=t(9851),w=t(7343),y=t(9513),k=t.n(y),_=(0,v.ZP)(d.Z)((function(e){var n=e.theme;return{"& input":{padding:"10px 20px",outline:"none",border:"1px solid ".concat(p.Z[300]),borderRadius:n.spacing(.5)},"& button":{paddingRight:n.spacing(1.5)},"& button::after":{backgroundColor:p.Z[400]}}})),F=function(e){var n=e.value,t=e.onChange,r=e.min,a=e.max,o=e.placeholder;return(0,D.jsx)(_,{children:(0,D.jsx)(k(),{closeOnScroll:!0,selected:n,onChange:function(e){return t(e)},maxDate:a,minDate:r,isClearable:!0,placeholderText:o})})};F.defaultProps={value:null,min:new Date("2017-01-01"),max:new Date("2050-01-01"),onChange:function(){},placeholder:"Date"};var H=(0,l.memo)(F),I=(0,l.memo)((function(e){var n=e.header,t=void 0!==n&&n,r=e.label;return(0,D.jsx)(D.Fragment,{children:t?(0,D.jsx)(d.Z,{sx:{border:"1px solid ".concat(p.Z[300]),pl:1.5,pr:1.5,pt:1,pb:1},children:(0,D.jsx)(x.Z,{variant:"body2",sx:{fontWeight:"bold",whiteSpace:"pre"},children:r})}):(0,D.jsx)(d.Z,{sx:{border:"1px solid ".concat(p.Z[300]),pl:1.5,pr:1.5,pt:.5,pb:.5},children:(0,D.jsx)(x.Z,{variant:"body2",sx:{whiteSpace:"pre"},children:r||" "})})})})),S=function(){var e=(0,u.v9)((function(e){return{products:e.Help.products,currentFc:e.Help.currentFc,fromDate:e.Help.fromDate,toDate:e.Help.toDate}}),u.wU),n=e.products,t=e.currentFc,s=e.fromDate,x=e.toDate,v=(0,l.useState)([]),Z=(0,o.Z)(v,2),b=Z[0],g=Z[1],C=(0,u.I0)();(0,l.useEffect)((function(){if(n){var e=(0,w.a)(n,t,s,x),o=e.map((function(e){return e.array.length})),l=Math.max.apply(Math,(0,a.Z)(o)),u=e.map((function(e){for(var n=l-e.array.length,t=(0,a.Z)(e.array),o=0;o<n;o++)t.push(0);return(0,r.Z)((0,r.Z)({},e),{},{array:(0,a.Z)(t)})}));g(u)}}),[t,n,s,x]);var y=(0,l.useCallback)((function(){!function(e){var n=Y.utils.book_new(),t=[],r=e[0].array.length,a=e.map((function(e){return{v:" ".concat(e.label," "),t:"s",s:{font:{bold:!0,sz:13}}}}));t.push(a);for(var o=a.length,l=0;l<r;l++){for(var u=[],c=0;c<o;c++){var s=e[c].array[l];0===s?u.push({v:"",t:"s",s:{font:{sz:13}}}):u.push({v:s,t:"s",s:{font:{sz:13}}})}t.push(u)}console.log(t);var d=Y.utils.aoa_to_sheet(t);Y.utils.book_append_sheet(n,d),Y.writeFile(n,"".concat(i()().format("MM-DD-HH-mm"),".xlsx"),{cellStyles:!0})}(b)}),[b]),k=(0,l.useCallback)((function(e){return function(n){if("from"===e){var t=null;n&&(t=i()(n).format("YYYY-MM-DD")),C((0,j.a$)(t)),x||C((0,j.KO)(t))}else{var r=null;n&&(r=i()(n).format("YYYY-MM-DD")),C((0,j.KO)(r)),s||C((0,j.a$)(r))}}}),[x,s]),_=(0,l.useMemo)((function(){var e={date:null},n={date:null};return s&&(e.date=i()(s,"YYYY-MM-DD").toDate(),n.min=e.date),x&&(n.date=i()(x,"YYYY-MM-DD").toDate(),e.max=n.date),{from:e,to:n}}),[s,x]);return(0,D.jsxs)(m.Z,{children:[(0,D.jsxs)(d.Z,{className:(0,c.Z)("flex","justify-between"),children:[(0,D.jsxs)(d.Z,{className:(0,c.Z)("flex"),children:[(0,D.jsx)(M,{}),(0,D.jsx)(d.Z,{sx:{pl:3},children:(0,D.jsx)(H,{placeholder:"From date",onChange:k("from"),value:_.from.date,max:_.to.date})}),(0,D.jsx)(h.Z,{sx:{ml:2,mr:2,color:p.Z[500]}}),(0,D.jsx)(H,{placeholder:"To date",onChange:k("to"),value:_.to.date,min:_.from.date})]}),(0,D.jsx)(f.Z,{variant:"contained",onClick:y,children:"Download xlsx"})]}),(0,D.jsx)(d.Z,{sx:{pt:2}}),(0,D.jsx)(d.Z,{sx:{overflow:"auto",pb:1},children:(0,D.jsx)(d.Z,{className:(0,c.Z)("flex-only"),sx:{pr:2},children:b.map((function(e,n){return(0,D.jsxs)(d.Z,{children:[(0,D.jsx)(I,{label:e.label,header:!0}),e.array.map((function(e,t){return(0,D.jsx)(I,{label:e},"el_".concat(n,"_").concat(t))}))]},"excel_".concat(n))}))})})]})},O=(0,l.memo)(S)},5234:function(){},3659:function(){}}]);
//# sourceMappingURL=489.a1c9e3e5.chunk.js.map