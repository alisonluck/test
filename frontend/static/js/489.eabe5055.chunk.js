(self.webpackChunkdavid_project=self.webpackChunkdavid_project||[]).push([[489],{6442:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return L}});var r=t(1413),a=t(2982),o=t(885),u=t(8214),c=t(5861),l=t(2791),s=t(5048),i=t(8182),p=t(2426),f=t.n(p),d=t(7494),x=t(2131),h=t(4554),m=t(5519),Z=t(6151),v=t(890),b=t(8264),D=t(1795),j=t(7630),g=t(412),w=t(2740),k=t(6409),y=t(4390),M=t(184),C=(0,j.ZP)(w.Z)((function(){return{"& .MuiOutlinedInput-root":{cursor:"pointer","& input.MuiOutlinedInput-input":{cursor:"pointer"}}}})),Y=function(){var e=(0,s.v9)((function(e){return{fcs:e.Help.fcs,fromDate:e.Help.fromDate,toDate:e.Help.toDate,currentFc:e.Help.currentFc}}),s.wU),n=e.fcs,t=e.currentFc,a=e.fromDate,i=e.toDate,p=l.useState(""),f=(0,o.Z)(p,2),d=f[0],x=f[1],h=(0,s.I0)(),m=(0,l.useMemo)((function(){return n||[]}),[n]),Z=(0,l.useCallback)(function(){var e=(0,c.Z)((0,u.Z)().mark((function e(n){var t,r;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return h((0,k.In)(n)),h((0,k.qA)("Loading...")),e.prev=2,e.next=5,y.Sg(n,a,i);case 5:(t=e.sent).data.status&&(r=t.data.result)&&h((0,k.d2)(r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),h((0,k.MA)({message:e.t0.message,status:!1}));case 12:h((0,k.qA)(null));case 13:case"end":return e.stop()}}),e,null,[[2,9]])})));return function(n){return e.apply(this,arguments)}}(),[a,i]);return(0,M.jsx)("div",{children:(0,M.jsx)(C,{value:t,onChange:function(e,n){Z(n)},disableClearable:!0,inputValue:d,onInputChange:function(e,n){x(n)},size:"small",options:m,sx:{width:250},renderInput:function(e){return(0,M.jsx)(g.Z,(0,r.Z)((0,r.Z)({},e),{},{label:"Warehouse"}))}})})},H=(0,l.memo)(Y),_=t(9851),F=t(9513),R=t.n(F),S=(0,j.ZP)(h.Z)((function(e){var n=e.theme;return{"& input":{padding:"10px 20px",outline:"none",border:"1px solid ".concat(m.Z[300]),borderRadius:n.spacing(.5)},"& button":{paddingRight:n.spacing(1.5)},"& button::after":{backgroundColor:m.Z[400]}}})),A=function(e){var n=e.value,t=e.onChange,r=e.min,a=e.max,o=e.placeholder;return(0,M.jsx)(S,{children:(0,M.jsx)(R(),{closeOnScroll:!0,selected:n,onChange:function(e){return t(e)},maxDate:a,minDate:r,isClearable:!0,placeholderText:o})})};A.defaultProps={value:null,min:new Date("2017-01-01"),max:new Date("2050-01-01"),onChange:function(){},placeholder:"Date"};var I=(0,l.memo)(A),q=function(){var e=(0,c.Z)((0,u.Z)().mark((function e(n,t,r){var a,o;return(0,u.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,y.Sg(n,t,r);case 3:if(!(a=e.sent).data.status){e.next=7;break}return o=a.data.result,e.abrupt("return",o);case 7:e.next=12;break;case 9:return e.prev=9,e.t0=e.catch(0),e.abrupt("return",null);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(n,t,r){return e.apply(this,arguments)}}(),O=(0,l.memo)((function(e){var n=e.header,t=void 0!==n&&n,r=e.label;return(0,M.jsx)(M.Fragment,{children:t?(0,M.jsx)(h.Z,{sx:{border:"1px solid ".concat(m.Z[300]),pl:1.5,pr:1.5,pt:1,pb:1},children:(0,M.jsx)(v.Z,{variant:"body2",sx:{fontWeight:"bold",whiteSpace:"pre"},children:r})}):(0,M.jsx)(h.Z,{sx:{border:"1px solid ".concat(m.Z[300]),pl:1.5,pr:1.5,pt:.5,pb:.5},children:(0,M.jsx)(v.Z,{variant:"body2",sx:{whiteSpace:"pre"},children:r||" "})})})})),z=function(){var e=(0,s.v9)((function(e){return{currentFc:e.Help.currentFc,fromDate:e.Help.fromDate,toDate:e.Help.toDate,currentResult:e.Help.currentResult}}),s.wU),n=e.currentFc,t=e.fromDate,p=e.toDate,v=e.currentResult,j=(0,l.useState)({index:1,allRows:[]}),g=(0,o.Z)(j,2),w=g[0],y=g[1],C=(0,s.I0)();(0,l.useEffect)((function(){if(v){var e=v.map((function(e){return e.array.length})),n=Math.max.apply(Math,(0,a.Z)(e)),t=v.map((function(e){for(var t=n-e.array.length,o=(0,a.Z)(e.array),u=0;u<t;u++)o.push(0);return(0,r.Z)((0,r.Z)({},e),{},{array:(0,a.Z)(o)})}));return y((function(e){return(0,r.Z)((0,r.Z)({},e),{},{allRows:t,index:1})}))}}),[v]);var Y=(0,l.useMemo)((function(){var e=w.allRows,n=w.index;return e.map((function(e){var t=e.array;return(0,r.Z)((0,r.Z)({},e),{},{array:t.filter((function(e,t){return!!e&&t<40*n}))})}))}),[w]),F=(0,d.debounce)((function(){y((function(e){return(0,r.Z)((0,r.Z)({},e),{},{index:e.index+1})}))}),100),R=(0,x.C)(F),S=(0,l.useCallback)((function(){!function(e){var n=_.utils.book_new(),t=[],r=e[0].array.length,a=e.map((function(e){return{v:" ".concat(e.label," "),t:"s",s:{font:{bold:!0,sz:13}}}}));t.push(a);for(var o=a.length,u=0;u<r;u++){for(var c=[],l=0;l<o;l++){var s=e[l].array[u];0===s?c.push({v:"",t:"s",s:{font:{sz:13}}}):c.push({v:s,t:"s",s:{font:{sz:13}}})}t.push(c)}console.log(t);var i=_.utils.aoa_to_sheet(t);_.utils.book_append_sheet(n,i),_.writeFile(n,"".concat(f()().format("MM-DD-HH-mm"),".xlsx"),{cellStyles:!0})}(w.allRows)}),[w]),A=(0,l.useCallback)((function(e){return function(){var r=(0,c.Z)((0,u.Z)().mark((function r(a){var o,c,l,s,i,d;return(0,u.Z)().wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if("from"!==e){r.next=14;break}return o=null,c=p,a&&(o=f()(a).format("YYYY-MM-DD")),C((0,k.a$)(o)),p||(c=o,C((0,k.KO)(c))),C((0,k.qA)("Loading...")),r.next=9,q(n,o,c);case 9:(l=r.sent)&&C((0,k.d2)(l)),C((0,k.qA)(null)),r.next=25;break;case 14:return s=null,i=t,a&&(s=f()(a).format("YYYY-MM-DD")),C((0,k.KO)(s)),t||(i=s,C((0,k.a$)(i))),C((0,k.qA)("Loading...")),r.next=22,q(n,i,s);case 22:(d=r.sent)&&C((0,k.d2)(d)),C((0,k.qA)(null));case 25:case"end":return r.stop()}}),r)})));return function(e){return r.apply(this,arguments)}}()}),[p,t,n]),z=(0,l.useMemo)((function(){var e={date:null},n={date:null};return t&&(e.date=f()(t,"YYYY-MM-DD").toDate(),n.min=e.date),p&&(n.date=f()(p,"YYYY-MM-DD").toDate(),e.max=n.date),{from:e,to:n}}),[t,p]);return(0,M.jsxs)(D.Z,{children:[(0,M.jsxs)(h.Z,{className:(0,i.Z)("flex","justify-between"),children:[(0,M.jsxs)(h.Z,{className:(0,i.Z)("flex"),children:[(0,M.jsx)(H,{}),(0,M.jsx)(h.Z,{sx:{pl:3},children:(0,M.jsx)(I,{placeholder:"From date",onChange:A("from"),value:z.from.date,max:z.to.date})}),(0,M.jsx)(b.Z,{sx:{ml:2,mr:2,color:m.Z[500]}}),(0,M.jsx)(I,{placeholder:"To date",onChange:A("to"),value:z.to.date,min:z.from.date})]}),(0,M.jsx)(Z.Z,{variant:"contained",onClick:S,children:"Download xlsx"})]}),(0,M.jsx)(h.Z,{sx:{pt:2}}),(0,M.jsx)(h.Z,{sx:{overflow:"auto",pb:1},ref:R,children:(0,M.jsx)(h.Z,{className:(0,i.Z)("flex-only"),sx:{pr:2},children:Y.map((function(e,n){return(0,M.jsxs)(h.Z,{children:[(0,M.jsx)(O,{label:e.label,header:!0}),e.array.map((function(e,t){return(0,M.jsx)(O,{label:e},"el_".concat(n,"_").concat(t))}))]},"excel_".concat(n))}))})})]})},L=(0,l.memo)(z)},5234:function(){},3659:function(){}}]);
//# sourceMappingURL=489.eabe5055.chunk.js.map